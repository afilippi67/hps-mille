(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     62469,       2058]
NotebookOptionsPosition[     58032,       1898]
NotebookOutlinePosition[     58441,       1916]
CellTagsIndexPosition[     58398,       1913]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Helix derivatives", "Title",
 CellChangeTimes->{{3.554576162869258*^9, 3.554576194104596*^9}, {
  3.554576226186665*^9, 3.554576240761374*^9}, {3.55457689032574*^9, 
  3.554576893955723*^9}}],

Cell["\<\
v1 .0 (8/22/2012)
Per Hansson Adrian  (phansson@slac.stanford.edu)
Sho Uemura  (meeg@slac.stanford.edu)\
\>", "Text",
 CellChangeTimes->{{3.554668086506496*^9, 3.554668140318084*^9}}],

Cell[CellGroupData[{

Cell["Point of closest approach in x - y plane", "Section",
 CellChangeTimes->{{3.5545769590903263`*^9, 3.554576975462843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x0", "[", 
    RowBox[{"xr_", ",", "d0_", ",", "phi0_"}], "]"}], ":=", 
   RowBox[{"xr", "-", 
    RowBox[{"d0", "*", 
     RowBox[{"Sin", "[", "phi0", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554555917750885*^9, 3.554555948813048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y0", "[", 
     RowBox[{"yr_", ",", " ", "d0_", ",", " ", "phi0_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"yr", " ", "+", " ", 
     RowBox[{"d0", "*", 
      RowBox[{"Cos", "[", "phi0", "]"}]}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.55455595961664*^9, 3.554555998435485*^9}, {
  3.554556385479308*^9, 3.554556405650136*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Center of the helix - circle in x - y plane", "Section",
 CellChangeTimes->{{3.5545762011485643`*^9, 3.554576220181925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xc", "[", 
    RowBox[{"xr_", ",", "R_", ",", "phi0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"xr", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R", "-", "d0"}], ")"}], "*", 
     RowBox[{"Sin", "[", "phi0", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5545560078151493`*^9, 3.554556050681426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"yc", "[", 
    RowBox[{"yr_", ",", "R_", ",", "phi0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"yr", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R", "-", "d0"}], ")"}], "*", 
     RowBox[{"Cos", "[", "phi0", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554556054647504*^9, 3.554556088425318*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic point on track in x - y plane", "Section",
 CellChangeTimes->{{3.5545762517437572`*^9, 3.554576270841527*^9}}],

Cell["With helper functions", "Text",
 CellChangeTimes->{{3.55466521926455*^9, 3.554665240725132*^9}, 
   3.554668613009246*^9, {3.5546689960787163`*^9, 3.554669008467146*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deltaxc", "[", 
    RowBox[{"R_", ",", "xint_", ",", "xr_", ",", "phi0_", ",", "d0_"}], "]"}],
    ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xint", "-", 
        RowBox[{"xc", "[", 
         RowBox[{"xr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}], ")"}], 
      "2"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554662360948571*^9, 3.5546623902599382`*^9}, {
   3.554667647753565*^9, 3.554667652545515*^9}, 3.5546677105675297`*^9, {
   3.554668910266445*^9, 3.5546689103455753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"yint", "[", 
    RowBox[{
    "xint_", ",", "xr_", ",", "yr_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"yc", "[", 
     RowBox[{"yr", ",", "R", ",", "phi0", ",", "d0"}], "]"}], "+", 
    RowBox[{
     RowBox[{"Sign", "[", "R", "]"}], "*", 
     RowBox[{"deltaxc", "[", 
      RowBox[{"R", ",", "xint", ",", "xr", ",", "phi0", ",", "d0"}], 
      "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554556297672073*^9, 3.554556327905902*^9}, {
   3.554556636415937*^9, 3.554556637575494*^9}, {3.554557406613965*^9, 
   3.554557410621953*^9}, {3.5545620534377613`*^9, 3.554562053577425*^9}, 
   3.554662317892787*^9, 3.554662396253291*^9, {3.554662444368905*^9, 
   3.554662455593965*^9}, {3.554667659768469*^9, 3.554667662481028*^9}, 
   3.5546677088634233`*^9, {3.554668815734756*^9, 3.554668815821056*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deltayc", "[", 
    RowBox[{
    "R_", ",", "xint_", ",", "xr_", ",", "yr_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yint", "[", 
         RowBox[{
         "xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "-", 
        RowBox[{"yc", "[", 
         RowBox[{"yr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}], ")"}], 
      "2"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554668727979911*^9, 3.5546687597352457`*^9}, 
   3.554668803926023*^9, 3.554668977739271*^9, {3.554669171122394*^9, 
   3.554669171465775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{
    "xint_", ",", "xr_", ",", "yr_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"xc", "[", 
     RowBox[{"xr", ",", "R", ",", "phi0", ",", "d0"}], "]"}], "+", 
    RowBox[{
     RowBox[{"Sign", "[", "R", "]"}], "*", 
     RowBox[{"deltayc", "[", 
      RowBox[{"R", ",", "xint", ",", "xr", ",", "phi0", ",", "d0"}], 
      "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5545751640406237`*^9, 3.55457518322394*^9}, {
  3.554575261981969*^9, 3.554575262333705*^9}, {3.554662461518448*^9, 
  3.554662464651751*^9}, {3.554667701921245*^9, 3.554667703863253*^9}, {
  3.554669165700472*^9, 3.554669166778183*^9}, {3.554669215312921*^9, 
  3.554669219200597*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Azimuthal angle", "Section",
 CellChangeTimes->{{3.5545762798794394`*^9, 3.5545762981111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "phi0_", ",", "R_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "phi0", "]"}], "-", 
      RowBox[{
       RowBox[{"1", "/", "R"}], "*", 
       RowBox[{"(", 
        RowBox[{"xint", "-", 
         RowBox[{"x0", "[", 
          RowBox[{"xr", ",", "d0", ",", "phi0"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "phi0", "]"}], "+", 
      RowBox[{
       RowBox[{"1", "/", "R"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yint", "[", 
          RowBox[{
          "xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
          "]"}], "-", 
         RowBox[{"y0", "[", 
          RowBox[{"yr", ",", "d0", ",", "phi0"}], "]"}]}], ")"}]}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554560213092005*^9, 3.554560408411508*^9}, {
  3.5545620888692636`*^9, 3.554562118594594*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Azimuthal angles to correct for 2*pi ambiguity and constrain dphi = [-pi, pi]\
\
\>", "Section",
 CellChangeTimes->{{3.5545763066621017`*^9, 3.554576351467237*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi1", "[", 
    RowBox[{"xr_", ",", "yr_", ",", "R_", ",", "d0_", ",", "phi0_"}], "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x0", "[", 
       RowBox[{"xr", ",", "d0", ",", "phi0"}], "]"}], "-", 
      RowBox[{"xc", "[", 
       RowBox[{"xr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"y0", "[", 
       RowBox[{"yr", ",", "d0", ",", "phi0"}], "]"}], "-", 
      RowBox[{"yc", "[", 
       RowBox[{"yr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.554560423885256*^9, 3.554560521902779*^9}, {
  3.5545608678035917`*^9, 3.554560868883239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi2", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"xint", "-", 
      RowBox[{"xc", "[", 
       RowBox[{"xr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"yint", "[", 
       RowBox[{
       "xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], "-", 
      RowBox[{"yc", "[", 
       RowBox[{"yr", ",", "R", ",", "phi0", ",", "d0"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.55456052926514*^9, 3.554560666425655*^9}, {
  3.554562132081417*^9, 3.554562157168619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tmpdphi", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"phi2", "[", 
     RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], "-", 
    RowBox[{"phi1", "[", 
     RowBox[{"xr", ",", "yr", ",", "R", ",", "d0", ",", "phi0"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.554560769057547*^9, 3.554560861387065*^9}, {
  3.554560896945909*^9, 3.554560931840794*^9}, {3.554562164505405*^9, 
  3.5545621831682663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dphi", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tmpdphi", "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], ">", "Pi"}], ",", 
     RowBox[{
      RowBox[{"tmpdphi", "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], "-", 
      RowBox[{"2", "*", "Pi"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "<", 
        RowBox[{"-", "Pi"}]}], ",", 
       RowBox[{
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "+", 
        RowBox[{"2", "*", "Pi"}]}], ",", 
       RowBox[{"tmpdphi", "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554560939867585*^9, 3.554560971719137*^9}, {
   3.5545610806197653`*^9, 3.5545612122832747`*^9}, {3.554562192682398*^9, 
   3.5545622124167337`*^9}, {3.554564642586182*^9, 3.5545646502398233`*^9}, {
   3.5545745955259943`*^9, 3.554574596517351*^9}, 3.5546605733475323`*^9, {
   3.554660843742242*^9, 3.554660844781785*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temporary dphi which has problem of 2 pi ambiguity?", "Section",
 CellChangeTimes->{{3.5545763575099297`*^9, 3.5545763817078037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dphiraw", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"phi2", "[", 
     RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], "-", 
    RowBox[{"phi1", "[", 
     RowBox[{"xr", ",", "yr", ",", "R", ",", "d0", ",", "phi0"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.554574602597316*^9, 3.55457464384993*^9}, {
  3.5546608483232927`*^9, 3.554660850571044*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arc length from (x0, y0) to (xint, yint)", "Section",
 CellChangeTimes->{{3.5545763891429*^9, 3.5545764350799313`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
    "xr_", ",", "yr_", ",", "xint_", ",", "R_", ",", "phi0_", ",", "d0_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "R"}], "*", 
    RowBox[{"dphi", "[", 
     RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554562292622509*^9, 3.554562374130364*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic position in z", "Section",
 CellChangeTimes->{{3.5545764591076183`*^9, 3.554576503406201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"z", "[", 
    RowBox[{
    "z0_", ",", "slope_", ",", "xr_", ",", "yr_", ",", "xint_", ",", "R_", 
     ",", "phi0_", ",", "d0_"}], "]"}], ":=", 
   RowBox[{"z0", "+", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{
      "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], "]"}],
      "*", "slope"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.554562386103504*^9, 3.554562469093486*^9}, {
  3.554563274923427*^9, 3.554563275666897*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives of z", "Section",
 CellChangeTimes->{{3.554574201067293*^9, 3.554574223250753*^9}, 
   3.554574344357376*^9, 3.5545771156657553`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogicalExpand", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{
     "z0", ",", "slope", ",", "xr", ",", "yr", ",", "xint", ",", "R", ",", 
      "phi0", ",", "d0"}], "]"}], ",", "slope"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574377660707*^9, 3.554574403304842*^9}, {
  3.55457443798386*^9, 3.554574439583291*^9}, {3.5546612501833267`*^9, 
  3.554661254614767*^9}, {3.5546629805390167`*^9, 3.554662991192679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "R"}], " ", "slope", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sign", "[", "R", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["R", "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xint", "-", "xr", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
                RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
        "]"}], "-", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "d0"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"d0", " ", 
           RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", "phi0", "]"}]}]}]}], "]"}]}], ">", "\[Pi]"}], 
     ",", "0", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "<", 
        RowBox[{"-", "\[Pi]"}]}], ",", "0", ",", "0"}], "]"}]}], "]"}]}], "-", 
  RowBox[{"R", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sign", "[", "R", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["R", "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xint", "-", "xr", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
                RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
        "]"}], "-", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "d0"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"d0", " ", 
           RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Cos", "[", "phi0", "]"}]}]}]}], "]"}]}], ">", "\[Pi]"}], 
     ",", 
     RowBox[{
      RowBox[{"tmpdphi", "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], "-", 
      RowBox[{"2", " ", "\[Pi]"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "<", 
        RowBox[{"-", "\[Pi]"}]}], ",", 
       RowBox[{
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}], "+", 
        RowBox[{"2", " ", "\[Pi]"}]}], ",", 
       RowBox[{"tmpdphi", "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}]}], "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.554674645486874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{
     "z0", ",", "slope", ",", "xr", ",", "yr", ",", "xint", ",", "R", ",", 
      "phi0", ",", "d0"}], "]"}], ",", "R"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554563483783613*^9, 3.5545635411933823`*^9}, {
  3.554574391898954*^9, 3.554574398905764*^9}, {3.554574448599125*^9, 
  3.554574450502902*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "slope"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"xint", "-", "xr", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d0", "-", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sign", "[", "R", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["R", "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xint", "-", "xr", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d0", "-", "R"}], ")"}], " ", 
                RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
        "]"}], ">", 
       RowBox[{"\[Pi]", "+", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "R"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}], ",", 
          RowBox[{"R", " ", 
           RowBox[{"Cos", "[", "phi0", "]"}]}]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"tmpdphi", "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}], "-", 
       RowBox[{"2", " ", "\[Pi]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tmpdphi", "[", 
          RowBox[{
          "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
          "]"}], "<", 
         RowBox[{"-", "\[Pi]"}]}], ",", 
        RowBox[{
         RowBox[{"tmpdphi", "[", 
          RowBox[{
          "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
          "]"}], "+", 
         RowBox[{"2", " ", "\[Pi]"}]}], ",", 
        RowBox[{"tmpdphi", "[", 
         RowBox[{
         "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
         "]"}]}], "]"}]}], "]"}], "+", 
    RowBox[{"R", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"xint", "-", "xr", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d0", "-", "R"}], ")"}], " ", 
            RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Sign", "[", "R", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["R", "2"], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"xint", "-", "xr", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d0", "-", "R"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
         "]"}], ">", 
        RowBox[{"\[Pi]", "+", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "R"}], " ", 
            RowBox[{"Sin", "[", "phi0", "]"}]}], ",", 
           RowBox[{"R", " ", 
            RowBox[{"Cos", "[", "phi0", "]"}]}]}], "]"}]}]}], ",", 
       RowBox[{
        SuperscriptBox["tmpdphi", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
           ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tmpdphi", "[", 
           RowBox[{
           "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
           "]"}], "<", 
          RowBox[{"-", "\[Pi]"}]}], ",", 
         RowBox[{
          SuperscriptBox["tmpdphi", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
             ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
          "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
          "]"}], ",", 
         RowBox[{
          SuperscriptBox["tmpdphi", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
             ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
          "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
          "]"}]}], "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.554674684959063*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{
     "z0", ",", "slope", ",", "xr", ",", "yr", ",", "xint", ",", "R", ",", 
      "phi0", ",", "d0"}], "]"}], ",", "z0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574456135832*^9, 3.5545744718782177`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.554674685101932*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{
     "z0", ",", "slope", ",", "xr", ",", "yr", ",", "xint", ",", "R", ",", 
      "phi0", ",", "d0"}], "]"}], ",", "d0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574499647111*^9, 3.5545745007412577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "R"}], " ", "slope", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"xint", "-", "xr", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d0", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Sign", "[", "R", "]"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["R", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"xint", "-", "xr", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d0", "-", "R"}], ")"}], " ", 
              RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
      "]"}], ">", 
     RowBox[{"\[Pi]", "+", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "R"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}], ",", 
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", "phi0", "]"}]}]}], "]"}]}]}], ",", 
    RowBox[{
     SuperscriptBox["tmpdphi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tmpdphi", "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}], "<", 
       RowBox[{"-", "\[Pi]"}]}], ",", 
      RowBox[{
       SuperscriptBox["tmpdphi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
          ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], ",", 
      RowBox[{
       SuperscriptBox["tmpdphi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
          ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}]}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.554674685140679*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"z", "[", 
     RowBox[{
     "z0", ",", "slope", ",", "xr", ",", "yr", ",", "xint", ",", "R", ",", 
      "phi0", ",", "d0"}], "]"}], ",", "phi0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574543771899*^9, 3.554574545132029*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "R"}], " ", "slope", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"xint", "-", "xr", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d0", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Sign", "[", "R", "]"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["R", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"xint", "-", "xr", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d0", "-", "R"}], ")"}], " ", 
              RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]}], 
      "]"}], ">", 
     RowBox[{"\[Pi]", "+", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "R"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}], ",", 
        RowBox[{"R", " ", 
         RowBox[{"Cos", "[", "phi0", "]"}]}]}], "]"}]}]}], ",", 
    RowBox[{
     SuperscriptBox["tmpdphi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tmpdphi", "[", 
        RowBox[{
        "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
        "]"}], "<", 
       RowBox[{"-", "\[Pi]"}]}], ",", 
      RowBox[{
       SuperscriptBox["tmpdphi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}], ",", 
      RowBox[{
       SuperscriptBox["tmpdphi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
       "xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
       "]"}]}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.554674685174362*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives of y", "Section",
 CellChangeTimes->{{3.554574731126091*^9, 3.5545747467128143`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"yint", "[", 
    RowBox[{"xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "z0"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574775741741*^9, 3.5545747809308443`*^9}, {
  3.554574842952894*^9, 3.5545748852561693`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.5546746852067337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"yint", "[", 
    RowBox[{"xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "slope"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574919671199*^9, 3.554574920839178*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.554674685238912*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"yint", "[", 
     RowBox[{"xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], ",", "d0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5545749274407387`*^9, 3.554574941086739*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cos", "[", "phi0", "]"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    RowBox[{"Sin", "[", "phi0", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"xint", "-", "xr", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d0", "-", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xint", "-", "xr", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d0", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.554674685692932*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"yint", "[", 
     RowBox[{"xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], ",", "phi0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574954814309*^9, 3.55457495779021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", "phi0", "]"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", "phi0", "]"}], " ", 
      RowBox[{"Sign", "[", "R", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"xint", "-", "xr", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d0", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"d0", "-", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.55467468642463*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"yint", "[", 
     RowBox[{"xint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}],
      "]"}], ",", "R"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.554574977765603*^9, 3.5545749828771257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"d0", "+", "R", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "phi0"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d0", "-", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]], "+", 
  RowBox[{
   SqrtBox[
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xint", "-", "xr", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d0", "-", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], " ", 
   RowBox[{
    SuperscriptBox["Sign", "\[Prime]",
     MultilineFunction->None], "[", "R", "]"}]}]}]], "Output",
 CellChangeTimes->{3.5546746868322687`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives of x", "Section",
 CellChangeTimes->{{3.554575035267074*^9, 3.554575045093808*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"yint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "z0"}], "]"}]], "Input",
 CellChangeTimes->{{3.55457520092596*^9, 3.554575204839079*^9}, {
  3.5545755202120857`*^9, 3.554575520955654*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.554674686865065*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"yint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "slope"}], "]"}]], "Input",
 CellChangeTimes->{{3.554575490284686*^9, 3.554575491580689*^9}, {
  3.554575527819974*^9, 3.554575528243531*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.554674686897047*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"yint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "d0"}], "]"}]], "Input",
 CellChangeTimes->{{3.554575496660502*^9, 3.5545754992042627`*^9}, {
  3.554575534539682*^9, 3.554575534931177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Sin", "[", "phi0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sign", "[", "R", "]"}], " ", 
   RowBox[{
    SuperscriptBox["deltayc", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"R", ",", "yint", ",", "xr", ",", "phi0", ",", "d0"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.554674686929225*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"yint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "phi0"}], "]"}]], "Input",
 CellChangeTimes->{{3.554575545828609*^9, 3.554575564410203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
   RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sign", "[", "R", "]"}], " ", 
   RowBox[{
    SuperscriptBox["deltayc", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"R", ",", "yint", ",", "xr", ",", "phi0", ",", "d0"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.554674686961877*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"yint", ",", "xr", ",", "yr", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "R"}], "]"}]], "Input",
 CellChangeTimes->{{3.554575571068119*^9, 3.554575575969833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", "phi0", "]"}], "+", 
  RowBox[{
   RowBox[{"deltayc", "[", 
    RowBox[{"R", ",", "yint", ",", "xr", ",", "phi0", ",", "d0"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["Sign", "\[Prime]",
     MultilineFunction->None], "[", "R", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Sign", "[", "R", "]"}], " ", 
   RowBox[{
    SuperscriptBox["deltayc", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"R", ",", "yint", ",", "xr", ",", "phi0", ",", "d0"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.554674686994526*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helper functions", "Section",
 CellChangeTimes->{{3.5546625590108*^9, 3.554662588911503*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"deltayc", "[", 
    RowBox[{"R", ",", "xint", ",", "xr", ",", "yr", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "R"}], "]"}]], "Input",
 CellChangeTimes->{{3.554662594919368*^9, 3.5546626065239077`*^9}, {
  3.5546626727462378`*^9, 3.554662676130043*^9}, {3.5546653298637733`*^9, 
  3.554665374182674*^9}, {3.5546654278941803`*^9, 3.5546654304202127`*^9}, {
  3.55466774483926*^9, 3.554667756116262*^9}, {3.5546693184001083`*^9, 
  3.554669335859709*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "R"}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "R"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", "phi0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["Sign", "\[Prime]",
      MultilineFunction->None], "[", "R", "]"}]}]}], 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["R", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"xint", "-", "xr", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
            RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}]}]]}]]], "Output",
 CellChangeTimes->{3.5546746870273457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"deltayc", "[", 
    RowBox[{"R", ",", "xint", ",", "xr", ",", "yr", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "phi0"}], "]"}]], "Input",
 CellChangeTimes->{{3.554669569804549*^9, 3.554669571220098*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
    RowBox[{"Cos", "[", "phi0", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"xint", "-", "xr", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["R", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"xint", "-", "xr", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
            RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}]}]]]}]], "Output",
 CellChangeTimes->{3.554674687060298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"deltayc", "[", 
    RowBox[{"R", ",", "xint", ",", "xr", ",", "yr", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "d0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5546695820039053`*^9, 3.5546695823316936`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "phi0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"xint", "-", "xr", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
      RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["R", "2"], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]}]]]], "Output",
 CellChangeTimes->{3.554674687093026*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"deltaxc", "[", 
    RowBox[{"R", ",", "xint", ",", "xr", ",", "phi0", ",", "d0"}], "]"}], ",",
    "R"}], "]"}]], "Input",
 CellChangeTimes->{{3.554669372484014*^9, 3.554669405273409*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "R"}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"Sin", "[", "phi0", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"xint", "-", "xr", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["R", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xint", "-", "xr", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]]], "Output",
 CellChangeTimes->{3.55467468712558*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"tmpdphi", "[", 
    RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "phi0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5546627866614227`*^9, 3.554662793942335*^9}, {
   3.554665320632332*^9, 3.554665323399688*^9}, 3.554667764350903*^9, {
   3.55466786895649*^9, 3.554667900023662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d0"}], " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], "2"], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d0", " ", 
         RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d0"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d0"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d0", " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d0"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
    RowBox[{"Cos", "[", "phi0", "]"}], " ", 
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"xint", "-", "xr", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["R", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"xint", "-", "xr", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
             RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], ")"}]}]}], 
     ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
    RowBox[{"Cos", "[", "phi0", "]"}], " ", 
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"xint", "-", "xr", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.554674687159286*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"tmpdphi", "[", 
    RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "d0"}], "]"}]], "Input",
 CellChangeTimes->{{3.554667924583362*^9, 3.554667925111112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"Sign", "[", "R", "]"}], " ", 
     RowBox[{"Sin", "[", "phi0", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xint", "-", "xr", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
         RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["R", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"xint", "-", "xr", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
              RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], ")"}]}]}],
       ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    RowBox[{"Sin", "[", "phi0", "]"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"xint", "-", "xr", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.554674687193328*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"tmpdphi", "[", 
    RowBox[{"xr", ",", "yr", ",", "xint", ",", "R", ",", "phi0", ",", "d0"}], 
    "]"}], ",", "R"}], "]"}]], "Input",
 CellChangeTimes->{{3.5546679545824537`*^9, 3.554667955109776*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d0"}], " ", 
       RowBox[{"Cos", "[", "phi0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "phi0", "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d0", " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d0"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Cos", "[", "phi0", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d0"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d0", " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Cos", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d0"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Sign", "[", "R", "]"}], " ", 
    RowBox[{"Sin", "[", "phi0", "]"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["R", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xint", "-", "xr", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
          RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"xint", "-", "xr", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], ")"}]}]}]], 
  "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"xint", "-", "xr", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
       RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Sign", "[", "R", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "R"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", "phi0", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"xint", "-", "xr", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
              RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["R", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"xint", "-", "xr", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
              RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]]}]], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["R", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"xint", "-", "xr", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
             RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}]], " ", 
       RowBox[{
        SuperscriptBox["Sign", "\[Prime]",
         MultilineFunction->None], "[", "R", "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"xint", "-", "xr", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
        RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sign", "[", "R", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"xint", "-", "xr", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "d0"}], "+", "R"}], ")"}], " ", 
           RowBox[{"Sin", "[", "phi0", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.554674687227971*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1211, 738},
WindowMargins->{{Automatic, 89}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 197, 3, 76, "Title"],
Cell[779, 27, 193, 5, 56, "Text"],
Cell[CellGroupData[{
Cell[997, 36, 127, 1, 67, "Section"],
Cell[1127, 39, 294, 8, 27, "Input"],
Cell[1424, 49, 401, 11, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1862, 65, 130, 1, 67, "Section"],
Cell[1995, 68, 360, 10, 27, "Input"],
Cell[2358, 80, 358, 10, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2753, 95, 124, 1, 67, "Section"],
Cell[2880, 98, 176, 2, 26, "Text"],
Cell[3059, 102, 635, 17, 33, "Input"],
Cell[3697, 121, 896, 20, 27, "Input"],
Cell[4596, 143, 758, 22, 33, "Input"],
Cell[5357, 167, 770, 19, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6164, 191, 100, 1, 67, "Section"],
Cell[6267, 194, 1027, 31, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7331, 230, 174, 4, 67, "Section"],
Cell[7508, 236, 721, 19, 27, "Input"],
Cell[8232, 257, 721, 21, 27, "Input"],
Cell[8956, 280, 595, 16, 27, "Input"],
Cell[9554, 298, 1537, 42, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11128, 345, 140, 1, 67, "Section"],
Cell[11271, 348, 545, 15, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11853, 368, 125, 1, 67, "Section"],
Cell[11981, 371, 411, 12, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12429, 388, 108, 1, 67, "Section"],
Cell[12540, 391, 504, 14, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13081, 410, 151, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[13257, 416, 478, 10, 27, "Input"],
Cell[13738, 428, 4260, 129, 138, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18035, 562, 422, 10, 27, "Input"],
Cell[18460, 574, 4530, 133, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23027, 712, 325, 8, 27, "Input"],
Cell[23355, 722, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23462, 728, 325, 8, 27, "Input"],
Cell[23790, 738, 2368, 73, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26195, 816, 325, 8, 27, "Input"],
Cell[26523, 826, 2368, 73, 85, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28940, 905, 103, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[29068, 910, 308, 7, 27, "Input"],
Cell[29379, 919, 72, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29488, 925, 258, 6, 27, "Input"],
Cell[29749, 933, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29856, 939, 296, 7, 27, "Input"],
Cell[30155, 948, 728, 23, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30920, 976, 295, 7, 27, "Input"],
Cell[31218, 985, 888, 29, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32143, 1019, 295, 7, 27, "Input"],
Cell[32441, 1028, 1355, 44, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33845, 1078, 101, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[33971, 1083, 302, 7, 27, "Input"],
Cell[34276, 1092, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34383, 1098, 304, 7, 27, "Input"],
Cell[34690, 1107, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34797, 1113, 303, 7, 27, "Input"],
Cell[35103, 1122, 475, 15, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35615, 1142, 254, 6, 27, "Input"],
Cell[35872, 1150, 551, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36460, 1173, 251, 6, 27, "Input"],
Cell[36714, 1181, 682, 20, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37445, 1207, 99, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[37569, 1212, 510, 10, 27, "Input"],
Cell[38082, 1224, 1685, 54, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39804, 1283, 260, 6, 27, "Input"],
Cell[40067, 1291, 1060, 35, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41164, 1331, 262, 6, 27, "Input"],
Cell[41429, 1339, 929, 31, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42395, 1375, 245, 6, 27, "Input"],
Cell[42643, 1383, 760, 25, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43440, 1413, 383, 8, 27, "Input"],
Cell[43826, 1423, 4974, 165, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48837, 1593, 258, 6, 27, "Input"],
Cell[49098, 1601, 2837, 91, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51972, 1697, 259, 6, 27, "Input"],
Cell[52234, 1705, 5758, 188, 171, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
